{"version":3,"sources":["pages/admin.category.js"],"names":["$","rep","nav","per","RESOURCES","ACTIONS","commonService","actions","canDoActions","CATEGORY","$categoryList","$pager","$addCategoryBtn","$addCategoryBtnMessage","$addModal","$addForm","find","$addNameInput","$addFormAlertMessage","$addFormSubmit","$editModal","$editForm","$editFormAlertMessage","$editFormSubmit","$deleteModal","$deleteBtn","urlParams","URLSearchParams","window","location","search","page","get","fillDataList","create","attr","addClass","removeClass","on","val","html","submit","e","preventDefault","valid","name","length","canDo","CREATE","category","getEntityByName","keys","text","insertEntity","createdOn","Date","updatedOn","modal","alertMessage","update","id","currentTarget","data","getEntityById","editId","UPDATE","existingNameCategory","result","updateEntity","delete","click","DELETE","deleteEntityById","pageSize","pageIndex","$categoryContainer","$categoryTemplate","READ","categories","getEntities","index","i","push","getRenderItem","tmpl","appendTo","updatePager","totalItems","$pageItemContainer","totalPage","Math","ceil","pageItem","pathname","append","item","createdAt","moment","format","updatedAt","jQuery","repository","navigationService","permissionService"],"mappings":"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","sourcesContent":["\"use strict\";\r\n\r\n\r\n(function ($, rep, nav, per, RESOURCES, ACTIONS, commonService) {\r\n    const actions = per.canDoActions(RESOURCES.CATEGORY);\r\n\r\n    const $categoryList = $('#category-list');\r\n    const $pager = $('#pager');\r\n\r\n    const $addCategoryBtn = $('#addCategoryBtn');\r\n    const $addCategoryBtnMessage = $('#addCategoryBtnMessage');\r\n    const $addModal = $('#addModal');\r\n    const $addForm = $addModal.find('form');\r\n    const $addNameInput = $addForm.find('[name=name]');\r\n    const $addFormAlertMessage = $addForm.find('#addFormAlertMessage');\r\n    const $addFormSubmit = $addForm.find('#addFormSubmit');\r\n\r\n    const $editModal = $('#editModal');\r\n    const $editForm = $editModal.find('form');\r\n    const $editFormAlertMessage = $editForm.find('#editFormAlertMessage');\r\n    const $editFormSubmit = $editForm.find('#editFormSubmit');\r\n\r\n    const $deleteModal = $('#deleteCategory');\r\n    const $deleteBtn = $deleteModal.find('#deleteBtn');\r\n\r\n    $(function () {\r\n        const urlParams = new URLSearchParams(window.location.search);\r\n        let page = urlParams.get('page');\r\n        if(!page || page < 1) page = 1;\r\n        fillDataList(page);\r\n\r\n        if (!actions.create) {\r\n            $addCategoryBtn.attr('disabled', true);\r\n            $addCategoryBtn.addClass('disabled');\r\n            $addCategoryBtnMessage.removeClass('d-none');\r\n        } else {\r\n            $addModal.on('show.bs.modal', function () {\r\n                $addNameInput.val('');\r\n                $addForm.find('[data-valmsg-for=name]').html('');\r\n                $addFormAlertMessage.addClass('d-none');\r\n            });\r\n            $addForm.submit(function (e) {\r\n                e.preventDefault();\r\n                if (!$addForm.valid()) return;\r\n                var name = $addNameInput.val();\r\n                if (!name || !name.length) return;\r\n                if (!per.canDo(RESOURCES.CATEGORY, ACTIONS.CREATE)) return;\r\n                var category = rep.getEntityByName(rep.keys.category, name);\r\n                if (category == null) {\r\n                    $addFormAlertMessage.text('');\r\n                    $addFormAlertMessage.addClass('d-none');\r\n\r\n                    $addFormSubmit.attr('disabled', true);\r\n                    rep.insertEntity(rep.keys.category, { name: name, createdOn: new Date(), updatedOn: new Date() });\r\n                    $addModal.modal('hide');\r\n                    fillDataList(1);\r\n\r\n                    commonService.alertMessage(`Add category ${name} is successfully!`);\r\n                } else {\r\n                    $addFormAlertMessage.text('Category name is existing');\r\n                    $addFormAlertMessage.removeClass('d-none');\r\n                }\r\n\r\n                $addFormSubmit.attr('disabled', false);\r\n            });\r\n        }\r\n\r\n\r\n        if (!actions.update) {\r\n            $categoryList.on('click', '.edit-category', function (e) {\r\n                commonService.alertMessage(\"You don't have update permission\");\r\n                return false;\r\n            });\r\n        } else {\r\n            $categoryList.on('click', '.edit-category[data-id]', function (e) {\r\n                e.preventDefault();\r\n                var id = $(e.currentTarget).data('id');\r\n                $editModal.data('id', id);\r\n                $editModal.modal('show');\r\n            });\r\n            $editModal.on('show.bs.modal', function (e) {\r\n                var id = $editModal.data('id');\r\n                var category = rep.getEntityById(rep.keys.category, id);\r\n                if (category) {\r\n                    $editFormAlertMessage.text('');\r\n                    $editFormAlertMessage.addClass('d-none');\r\n                    $editForm.find('[name=name]').val(category.name);\r\n                } else {\r\n                    $editFormAlertMessage.text('Category is not found');\r\n                    $editFormAlertMessage.removeClass('d-none');\r\n                }\r\n                $editModal.find('[data-valmsg-for=name]').html('');\r\n            });\r\n            $editForm.submit(function (e) {\r\n                e.preventDefault();\r\n                if (!$editForm.valid()) return;\r\n                var name = $editForm.find('[name=name]').val();\r\n                var editId = $editModal.data('id');\r\n                if (!name || !name.length) return;\r\n                if (!per.canDo(RESOURCES.CATEGORY, ACTIONS.UPDATE)) return;\r\n                var category = rep.getEntityById(rep.keys.category, editId);\r\n                if (category == null) {\r\n                    $editFormAlertMessage.text('Category is not found');\r\n                    $editFormAlertMessage.removeClass('d-none');\r\n                } else {\r\n                    var existingNameCategory = rep.getEntityByName(rep.keys.category, name);\r\n                    if (existingNameCategory == null || existingNameCategory != null && existingNameCategory.id == category.id) {\r\n                        $editFormAlertMessage.text('');\r\n                        $editFormAlertMessage.addClass('d-none');\r\n\r\n                        $editFormSubmit.attr('disabled', true);\r\n                        var result = rep.updateEntity(rep.keys.category, category.id, { name: name, updatedOn: new Date() });\r\n                        if (result) {\r\n                            commonService.alertMessage(`Update category is successfully!`);\r\n                        } else {\r\n                            commonService.alertMessage(`Update category is failed!`);\r\n                        }\r\n                        $editModal.modal('hide');\r\n                        fillDataList(1);\r\n\r\n                    } else {\r\n                        $editFormAlertMessage.text('Category name is existing');\r\n                        $editFormAlertMessage.removeClass('d-none');\r\n                    }\r\n                }\r\n\r\n                $editFormSubmit.attr('disabled', false);\r\n\r\n            });\r\n        }\r\n        \r\n        if (!actions.delete) {\r\n            $categoryList.on('click', '.delete-category', function (e) {\r\n                commonService.alertMessage(\"You don't have delete permission\");\r\n                return false;\r\n            });\r\n        } else {\r\n            $categoryList.on('click', '.delete-category[data-id]', function (e) {\r\n                e.preventDefault();\r\n                var id = $(e.currentTarget).data('id');\r\n                $deleteBtn.data('id', id);\r\n                $deleteModal.modal('show');\r\n            });\r\n            $deleteBtn.click(function (e) {\r\n                e.preventDefault();\r\n                var id = $deleteBtn.data('id');\r\n                if (!id) return;\r\n                if (!per.canDo(RESOURCES.CATEGORY, ACTIONS.DELETE)) {\r\n                    commonService.alertMessage(\"You don't have delete permission\");\r\n                    $deleteModal.modal('hide');\r\n                    return;\r\n                }\r\n                var category = rep.getEntityById(rep.keys.category, id);\r\n                if (category == null) {\r\n                    commonService.alertMessage('Category is not found');\r\n                } else {\r\n                    var result = rep.deleteEntityById(rep.keys.category, category.id);\r\n                    if (result) {\r\n                        commonService.alertMessage(`Delete category '${category.name}' is successfully`);\r\n                        $deleteModal.modal('hide');\r\n                        fillDataList(1);\r\n                    } else {\r\n                        commonService.alertMessage(`Delete category '${category.name}' is failed`);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    function fillDataList(page) {\r\n        const pageSize = 5;\r\n        const pageIndex = page - 1;\r\n\r\n        const $categoryContainer = $categoryList.find('tbody');\r\n        const $categoryTemplate = $('#categoryTemplate');\r\n        $categoryContainer.html('');\r\n\r\n        if (per.canDo(RESOURCES.CATEGORY, ACTIONS.READ)) {\r\n            const categories = rep.getEntities(rep.keys.category) || [];\r\n            if (categories && categories.length) {\r\n                const data = [];\r\n                let index = 1;\r\n                for(var i = pageSize * pageIndex; i < pageSize * page && i < categories.length; i++){\r\n                    data.push(getRenderItem(categories[i], index++));\r\n                }\r\n                $categoryTemplate.tmpl(data).appendTo($categoryContainer);\r\n                updatePager(page, categories.length, pageSize);\r\n            } else {\r\n                $categoryContainer.html(`<tr><td colspan=\"5\"><div class=\"alert alert-info\">Categories data is empty</div></td></tr>`);\r\n            }\r\n        } else {\r\n            $categoryContainer.html(`<tr><td colspan=\"5\"><div class=\"alert alert-info\">You don't have read permission</div></td></tr>`);\r\n        }\r\n    }\r\n    function updatePager(page, totalItems, pageSize){\r\n        const $pager = $('#pager');\r\n        const $pageItemContainer = $pager.find('.pagination');\r\n        const totalPage = Math.ceil(totalItems / pageSize);\r\n        if(totalPage <= 1){\r\n            $pageItemContainer.html('');\r\n            $pager.addClass('d-none');\r\n        } else {\r\n            for(var i = 1; i < totalPage + 1; i++){\r\n                var pageItem = `<li class=\"page-item ${i == page ? 'active' : ''}\"><a class=\"page-link\" href=\"${location.pathname}?page=${i}\">${i}</a></li>`;\r\n                $pageItemContainer.append(pageItem);\r\n            }\r\n            $pager.removeClass('d-none');\r\n        }\r\n    }\r\n    function getRenderItem(item, index) {\r\n        return {\r\n            index: index + 1,\r\n            name: item.name,\r\n            id: item.id,\r\n            createdAt: moment(new Date(item.createdOn)).format('D MMM YYYY'),\r\n            updatedAt: moment(new Date(item.updatedOn)).format('D MMM YYYY')\r\n        };\r\n    }\r\n\r\n})(jQuery, repository, navigationService, permissionService, RESOURCES, ACTIONS, commonService);"],"file":"admin.category.js"}